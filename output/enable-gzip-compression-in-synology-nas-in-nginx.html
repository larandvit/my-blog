<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml"><head><title>Enable gzip Compression in Synology DSM in Nginx - tech jogging</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Vitaly Saversky's personal blog includes technical articles aimed to share knowledge and experience with others."><link rel="canonical" href="/enable-gzip-compression-in-synology-nas-in-nginx.html"><meta name="author" content="Vitaly Saversky"><meta name="description" content="Enabling gzip compression for your website can be done in Synology DiskStation Manager (DSM). HTTP traffic is already compressed with gzip as default. HTTPS protocol needs to be enabled explicitly. Synology DSM is doing it in an easy step without rebooting Synology NAS. Also, Synology DSM includes text/javascript and …"><meta property="og:site_name" content="tech jogging"><meta property="og:type" content="article"><meta property="og:title" content="Enable gzip Compression in Synology DSM in Nginx"><meta property="og:url" content="/enable-gzip-compression-in-synology-nas-in-nginx.html"><meta property="og:description" content="Enabling gzip compression for your website can be done in Synology DiskStation Manager (DSM). HTTP traffic is already compressed with gzip as default. HTTPS protocol needs to be enabled explicitly. Synology DSM is doing it in an easy step without rebooting Synology NAS. Also, Synology DSM includes text/javascript and …"><meta property="article:published_time" content="2020-03-21"><meta property="article:section" content="Synology DSM"><meta property="article:author" content="Vitaly Saversky"><link rel="stylesheet" href="/theme/css/bootstrap.flatly.min.css" type="text/css"><link href="/theme/css/font-awesome.min.css" rel="stylesheet"><link href="/theme/css/pygments/monokai.css" rel="stylesheet"><link href="/theme/tipuesearch/tipuesearch.css" rel="stylesheet"><link rel="stylesheet" href="/theme/css/style.css" type="text/css"></head><body><div class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand"><img alt="tech jogging" class="img-responsive pull-left gap-right" src="/extra/site-logo.png" width> tech jogging </a></div><div class="collapse navbar-collapse navbar-ex1-collapse"><ul class="nav navbar-nav"><li><a href="/pages/about-blog.html"> About blog </a></li></ul><ul class="nav navbar-nav navbar-right"><li><span><form class="navbar-search" action="/search.html"><input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" pattern=".{3,}" title="At least 3 characters" required><button type="submit" class="tipue_search_button"><div class="tipue_search_icon">&#9906;</div></button></form></span></li></ul></div></div></div><div class="container"><div class="row"><div class="col-sm-9"><section id="content"><article><header class="page-header"><h1><a href="/enable-gzip-compression-in-synology-nas-in-nginx.html" rel="bookmark" title="Permalink to Enable gzip Compression in Synology DSM in Nginx"> Enable gzip Compression in Synology DSM in Nginx </a></h1></header><div class="entry-content"><div class="panel"><div class="panel-body"><footer class="post-info"><span class="label label-default">Date</span><span class="published"><i class="fa fa-calendar"></i><time datetime="2020-03-21T00:00:00-04:00"> Sat 21 March 2020</time></span><span class="label label-default">Category</span><a href="/category/synology-dsm.html">Synology DSM</a>, <a href="/category/nginx.html">Nginx</a></footer></div></div><p>Enabling gzip compression for your website can be done in Synology DiskStation Manager (DSM). HTTP traffic is already compressed with gzip as default. HTTPS protocol needs to be enabled explicitly. Synology DSM is doing it in an easy step without rebooting Synology NAS. Also, Synology DSM includes text/javascript and text/css MIME types additional to text/html one.</p><h2>1. Validate Compression</h2><h3>1.1 Firefox Web browser</h3><ul><li><p>Open your website in Firefox browser </p></li><li><p>Click <strong>Shift-F12</strong> to open <strong>Developer Tools</strong> panels.</p><p><img alt="Firefox Developer Tools" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/firefox-developer-tools-panels.png"></p></li><li><p>Go to <strong>Network</strong> panel</p><p><img alt="Firefox Developer Tools Network Panel" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/firefox-network-panel.png"></p></li><li><p>Click <strong>Reload</strong> button in the panel or <strong>Ctrl-F5</strong> buttons to initiate your website data load.</p><p><img alt="Firefox Developer Tools Network Panel Loaded Data" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/firefox-website-loaded-data.png"></p></li><li><p>Filter resources which you are interested in. Those resources are: <strong>HTML</strong>, <strong>CSS</strong>, and <strong>JS</strong>, for example, <strong>HTML</strong> website root page.</p><p><img alt="Firefox Developer Tools Network Panel Filtered Recources" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/firefox-network-panel-filter-html.png"></p></li><li><p>Click on a resource to see compression and other resource properties, for example, <strong>HTML</strong> resource.</p><p>Clear cache.</p><p><img alt="Firefox Developer Tools Network Panel Compression Property" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/firefox-clear-cache.png"></p><p>Gzip compression is set up.</p><p><img alt="Firefox Developer Tools Network Panel Compression Property" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/firefox-html-resource-compression.png"></p></li></ul><h3>1.2 Chrome Web browser</h3><p>The steps to get information are very similar to Firefox. To open Chrome DevTools, press <strong>Command+Option+C</strong> (Mac) or <strong>Ctrl+Shift+C</strong> (Windows, Linux, Chrome OS).</p><p><img alt="Chrome DevTools Network Panel Compression Property" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/chrome-html-resource-compression.png"></p><h2>2. Enable gzip Compression in DSM</h2><ul><li><p>Open <strong>Control Panel</strong> in Synology DiskStation Manager.</p><p><img alt="Synology NAS DSM Control Panel" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/synology-diskstation-control-panel.png"></p></li><li><p>Go to <strong>Security</strong> settings.</p><p><img alt="Synology NAS DSM Control Panel Security Settings" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/synology-diskstation-security.png"></p></li><li><p>Select <strong>Advanced</strong> tab and flag <strong>Enable HTTP Compression</strong>.</p><p><img alt="Synology NAS DSM Control Panel Security Settings Advanced Tab" src="/images/enable-gzip-compression-in-synology-nas-in-nginx/synology-diskstation-security-enable-http-compression.png"></p></li><li><p>Apply the setting pressing <strong>Save</strong> button.</p></li></ul><h2>3. Include Different MIME Types</h2><p>Compression is applied to HTML MIME type as default. Also, compression is applied to CSS and JS in Synology DSM. If compression is missing for CSS and JS resources, it can be set up.</p><p>The sample is based on DSM 6.2.2 operation system.</p><ul><li><p>Use ssh client to access your Synology NAS with a user which has administrative permission. It can be PuTTY tool in Windows or terminal with <code>ssh</code> command in Unix. </p></li><li><p>Switch to root user.</p><div class="highlight"><pre><span></span>sudo su -
</pre></div></li><li><p>Back up the current moustache template.</p><div class="highlight"><pre><span></span>cp /usr/syno/share/nginx/WWWService.mustache /usr/syno/share/nginx/WWWService.mustache.bak
</pre></div></li><li><p>Open the moustache template for editing.</p><div class="highlight"><pre><span></span>vi /usr/syno/share/nginx/WWWService.mustache
</pre></div></li><li><p>Add a line after <code>gzip on;</code> command to both HTTP and HTTPS server sections.</p><div class="highlight"><pre><span></span>gzip_types text/javascript text/css;
</pre></div><p>The final content should be.</p><div class="highlight"><pre><span></span>server {
    listen 80 default_server{{#reuseport}} reuseport{{/reuseport}};
    listen [::]:80 default_server{{#reuseport}} reuseport{{/reuseport}};

    gzip on;
    gzip_types text/javascript text/css;

    {{&gt; /usr/syno/share/nginx/WWW_Main}}

    location ~ ^/$ {
        rewrite / http://$host:{{DSM.port}}/ redirect;
    }
}

server {
    listen 443 default_server ssl{{#reuseport}} reuseport{{/reuseport}};
    listen [::]:443 default_server ssl{{#reuseport}} reuseport{{/reuseport}};
    {{#DSM.https.compression}}
    gzip on;
    gzip_types text/javascript text/css;
    {{/DSM.https.compression}}

    {{&gt; /usr/syno/share/nginx/WWW_Main}}

    location ~ ^/$ {
        rewrite / https://$host:{{DSM.ssl.port}}/ redirect;
    }
}
</pre></div></li><li><p>Restart the Nginx web server to apply the changes.</p><div class="highlight"><pre><span></span>synoservicecfg --restart nginx
</pre></div></li></ul></div><hr><section class="comments" id="comments"><h2>Comments</h2><div id="disqus_thread"></div><script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'techjogging'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "en";

                        this.page.identifier = '2020-03-21-enable-gzip-compression-in-synology-nas-in-nginx';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></article></section></div><div class="col-sm-3" id="sidebar"><aside><section class="well well-sm"><ul class="list-group list-group-flush"><li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4><ul class="list-group" id="recentposts"><li class="list-group-item"><a href="/fast-record-count-in-table-or-tables-in-database-in-sql-server.html">Fast Record Count in Table or Tables in Database in SQL Server</a></li><li class="list-group-item"><a href="/redirect-404-error-to-specified-url-in-synology-dsm.html">Redirect 404 Error to Specified URL in Synology DSM</a></li><li class="list-group-item"><a href="/redirect-www-to-https-in-synology-nas-nginx.html">Redirect WWW to HTTPS in Synology DSM Nginx</a></li><li class="list-group-item"><a href="/connect-dbeaver-to-ms-sql-server-with-jaas-using-kerberos-keytab-file-in-windows.html">Connect DBeaver to MS SQL Server with JAAS Using Kerberos Keytab in Windows</a></li><li class="list-group-item"><a href="/connect-dbeaver-to-ms-sql-server-with-kerberos-ticket-cache-in-windows.html">Connect DBeaver to MS SQL Server with Kerberos Ticket Cache in Windows</a></li></ul></li><li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4><ul class="list-group" id="categories"><li class="list-group-item"><a href="/category/cron.html"><i class="fa fa-folder-open fa-lg"></i>Cron</a></li><li class="list-group-item"><a href="/category/dbeaver.html"><i class="fa fa-folder-open fa-lg"></i>DBeaver</a></li><li class="list-group-item"><a href="/category/docker.html"><i class="fa fa-folder-open fa-lg"></i>Docker</a></li><li class="list-group-item"><a href="/category/hive.html"><i class="fa fa-folder-open fa-lg"></i>Hive</a></li><li class="list-group-item"><a href="/category/https.html"><i class="fa fa-folder-open fa-lg"></i>HTTPS</a></li><li class="list-group-item"><a href="/category/kerberos.html"><i class="fa fa-folder-open fa-lg"></i>Kerberos</a></li><li class="list-group-item"><a href="/category/linux.html"><i class="fa fa-folder-open fa-lg"></i>Linux</a></li><li class="list-group-item"><a href="/category/microsoft-access.html"><i class="fa fa-folder-open fa-lg"></i>Microsoft Access</a></li><li class="list-group-item"><a href="/category/microsoft-excel.html"><i class="fa fa-folder-open fa-lg"></i>Microsoft Excel</a></li><li class="list-group-item"><a href="/category/ms-sql-server.html"><i class="fa fa-folder-open fa-lg"></i>MS SQL Server</a></li><li class="list-group-item"><a href="/category/nginx.html"><i class="fa fa-folder-open fa-lg"></i>Nginx</a></li><li class="list-group-item"><a href="/category/synology-dsm.html"><i class="fa fa-folder-open fa-lg"></i>Synology DSM</a></li><li class="list-group-item"><a href="/category/virtualization.html"><i class="fa fa-folder-open fa-lg"></i>Virtualization</a></li><li class="list-group-item"><a href="/category/windows-tools.html"><i class="fa fa-folder-open fa-lg"></i>Windows Tools</a></li></ul></li></ul></section></aside></div></div></div><footer><div class="container"><hr><div class="row"><div class="col-xs-10">&copy; 2020 Vitaly Saversky &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>, <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>, <a href="http://getbootstrap.com" target="_blank">Bootstrap</a></div><div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i><a href="#">Back to top</a></p></div></div></div></footer><script src="/theme/js/jquery.min.js"></script><script src="/theme/js/bootstrap.min.js"></script><script src="/theme/js/respond.min.js"></script><script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'techjogging'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script><script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-156524189-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script></body></html>